# 협업 추천 알고리즘 (유저 기반) 
: 사용자가 방문했던 식당 기록(히스토리)을 기반으로, 사용자와 비슷한 사람들이 좋은 평점을 주었던 식당을 추천
* 적합한 고객: 식당 평점을 많이 준 고객(=밀리언 이용횟수가 많은 고객)
### 장점
-  밀리언을 많이 사용한 사람일 수록, 정확도가 높은 추천을 해줄 수 있다.
### 단점
    
    1.데이터가 없는 신규 고객일 경우, 추천 정확도가 낮다. (cold start)
    
    2.인기있는 소수의 식당들 위주로 추천을 해준다. 소외되는 식당들이 생긴다.
    (평가가 되지 않았거나, 새로 생긴 식당 등의 경우에는 추천을 받지 못함)
    
    3.사용자가 많을수록 회사 내 데이터 베이스 추천 알고리즘 적용 시간이 길어진다. 단, 사용자가 많더라도 밀리언 어플로 추천 서비스를 제공하는 시간은 늘어나지 않는다.
 ### 종류
  SVD, KNN, BASELINEONLY 등등… (세부적으로 들어가면 10개 이상)
    
    밀리언 고객 데이터에 적용했을 때 정확도가 높은 알고리즘은 SVD(1순위), KNNwithBaseline(2순위), BaseLineOnly(3순위) 이다.
  >> SVD: 사용자 간 유사도와 아이템 간의 유사도를 행렬 차원 축소로 계산해준다.
    
    장점: SVD는 최소의 오차(SSE, RMSE와 유사)를 가진다. RMSE 또한 최소가 된다.
    
    단점: 유저에게 아이템을 추천하는데 구체적인 설명이나 이유가 없다. 
    
    SVD의 RMSE: 0.77 
    
>> KNNBaseLine: KNN은 사용자와 유사한 사용자들이 특정 아이템에 어떤 평점을 매겼는지 고려해 평점을 예측해준다. KNNBaseLine은 유사 사용자들의 평점들을 그대로 계산하지 않고,  Baseline을 이용해 계산해준다.
    
    장점: 단순하고 이해하기 직관적이다.
    
    단점:
    
     -사람들이 많이 가는 식당 위주로만 추천이 된다. 만약 고객과 비슷한 이웃중에서 아무도 A 식당을 가보지 않으면 A 식당 평점 예측을 할 수 없다.
    
     -데이터가 많을 때 분석속도가 느리다.
    
    KNNBaseLine의 rmse: 0.788
    
>> Baseline:  사용자와 상품 아이디로 평점을 예측하는 가장 단순한 회귀분석모형이다.
    
    가장 간단하면서도 직관적이면서 최소한의 성능을 나타내는 기준이 되는 모델을 기준모델이라고 한다. Baseline은 평점의 평균값을 기준모델로 사용한다.
    
    장점: 다른 모형에 비해 상대적으로 학습이 빠르며 설명력이 좋다.
    
    단점: 모델이  단순해서 학습 데이터와 잘 맞지 않는다.(과소 적합)
    
    BASELINEONLY (als)의 rmse: 0.76601
    
  ### KNN

    - 최근접 이웃 기간 - 유사도 계산
        - 평균 제곱 차이 유사도 MSD : 유클리드 공간 거리 제곱 비례
        - 코사인 유사도 : 두 특성 벡터의 각도에 대한 코사인 값
        - 피어슨 유사도 : 두 벡터의 상관계수
        - 피어슨 - 베이스라인 유사도: 피어슨 유사도처럼 상관계수 구하지만, 각 벡터의 기댓값은 단순 평균이 아닌 베이스 모형에서 예측한 값 사용
    - KNN 가중치 예측 방법
        - KNN Basic: 평점들을 단순히 가중 평균
        - KNN with Means: 평점들을 평균값 기준으로 가중 평균
        - KNN Baseline: 평점들을 베이스라인 모형 값 기준으로 가중 평균


### baseline only

    1) als 방식 장점 : 복잡한 함수를 쉽게 빠르게 구하다 

    2) SGD 방식: gradient descent 방법

    장점: 미분 가능하다면 꽤 그럴싸한 정답 제공

    단점: training 시간이 비교적 길다.

    - baselineonly의 option
        - ALS option

             - reg_i : 상품에 대한 정규화 가중치 , 디폴트 값: 10

             - reg_u : 사용자에 대한 정규화 가중치, 디폴트 값: 15

             - n_epochs : 반복 횟수 , 디폴트 값: 15 
            ex) 1 - epoch : 모델이 전체 데이터를 한번 보다

        - SGD option

             - reg : 정규화 가중치 , 디폴트 값: 0.02

             - learning rate: 최적화 스텝 사이즈 , 디폴트 값: 0.005

             - n_epochs: 최적화 반복횟수 , 디폴트 값: 20


### Matrxi Factorizion

    - SVD options
        - n_factors : 차원의 개수, 디폴트 값: 100
        - n_epochs : 최적화 반복횟수, 디폴트 값: 20
    - SVDpp options
        - n_factors 디폴트 값: 20
        - n_epochs  디폴트 값: 20
    - NMF options
        - n_factors 디폴트 값: 15
        - n_epochs  디폴트 값: 50

### 추천 성능 평가 기준

    - RMSE(Root Mean Squared Error): 잔차를 제곱하고 다 더한 후 루트 씌우다, 값이 작을 수록 좋다.
    장점: 큰 오류값 차이에 대해 크게 패널티를 준다, MAE에 비해 직관성은 떨어지지만 극단적이지 않다.
    - MAE(Mean Absolute Error): 잔차값(예측값과 실제값의 차이를 절대값 취하고 평균을 낸 것)
    - FCP(Fraction of Concordant Pairs): 평점이 아닌 사용자별 선호도 랭킹 기반 계산식



### Surprise Library 추천 알고리즘

    - Random Predict: Normal Predictor → 정규분포 가정한 평점분포에서 랜덤하게 샘플링 → 최대가능도 방법 이용(maximum Likelihood), 평균과 표준편차 구하다.
    - KNN 알고리즘
        - KNN Basic: 기본적인 협업 필터링 알고리즘
        - KNN with Means: 기본적인 협업 필터링 알고리즘  + 평균값을 더해준다.
        - KNN with Zscore: 기본적인 협업 필터링 알고리즘  + z-score 분포를 적용한다.
        - KNN Baseline: 기본적인 협업 필터링 알고리즘  + Baseline을 더해준다.
    - Matrix Factorization 알고리즘
        - SVD: 특이값 분해 알고리즘
        - SVD++: 특이값 분해 알고리즘에 추가적으로 암시적 rating이 더해진다.
        - NMF: Non-Negative 행렬분해, 음수를 포함하지 않는 행렬 X를 음수를 포함하지 않는 W와 H의 곱을 분해하는 알고리즘 
        유용한 점: 데이터가 non-negative일때 non-negative-feaure 설명하는게 좋다.
    - Baseline Only: User와 Item의 Baseline이용한 평점 예측 알고리즘

    
 ### 밀리언 데이터에 적용했을 때 문제점 & 해결 방법
    
    - 문제점: 전국적인 식당 평점 데이터가 적다. 반면 춘천 식당 데이터는 풍부하다. 데이터가 편중되었다. 
    
    -> 춘천 외 지역, (유저-식당-평점)데이터가 부족한 지역에서는 유저에게 맞춤형 데이터를 제공하기 힘들다. 데이터가 부족한 지역에서는 대부분의 유저들이 비슷한 식당을 추천받는다.
    
    해결방법: 유저-식당-평점 전국적인 데이터를 얻다. (전국적으로 조화롭게 데이터 양이 있을 필요성이 있다)
    
    첫번쨰: 공공 데이터, 사기업 데이터(유저-식당-평점)를 얻어 밀리언 데이터에 붙인다.
    
    두번째: 크롤링 방법(네이버, 구글, 카카오 지도)으로 데이터(유저-식당-평점)을 얻는다.
 
#### 현재 SVD 추천 알고리즘 문제점 
![Untitled](https://user-images.githubusercontent.com/90318043/158060061-99570121-3601-4e7c-980f-44d04022544b.png)
  ### 현재 협업 기반 알고리즘으로 가능한 추천 방식:

사전 지역 선택 추천 알고리즘: 지역 설정을 미리하고, 각 사용자 취향에 어울리는 식당을 추천해줄 수 있다.
- ex1) 특정 유저가, 현재, 특정 지역을 선택하고 추천받기를 누르면, 특정 콘텐츠들을 추천이 가능함
- ex2) 특정 카테고리만의 선택 가능함→ 후처리 방식으로 순위 이어붙이기

